#!/usr/bin/env python3
import os
import hashlib
import sys
import sys

sys.path.append('../utils/')
from malware import *
from colors import *

# Globals
dropbox = "dropbox/"
saved_specimens = "saved-specimens/"

# Utility Functions

def enum_malware_samples():
    samples = []
    for file in os.listdir(dropbox):
        print(file)
        samples.append(dropbox + file)
    return samples

# Defang
# Prefix is 'Malware' until more analysis is completed, then it can be changed to "RAT", "Ransomware", etc
def defang_samples(samples):
    # TODO
    prefix = "Malware"
    print("Defang!")

# Hashes
def get_hashes(samples):
    hashes = []
    for sample in samples:
        sha256_hash = hashlib.sha256()
        with open(sample, "rb") as f:
            for byte_block in iter(lambda: f.read(4096), b""):
                sha256_hash.update(byte_block)
            sha256_value = sha256_hash.hexdigest()
        print(good + "Sample: " + sample + " SHA256 SUM: " + str(sha256_value))
        hashes.append(sha256_value)
    return hashes

# FLOSS output
# TODO

# Save specimen in password protected zip file with a standard naming convention
# TODO

